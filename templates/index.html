<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asteroid Impact Simulator</title>

    <!-- Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    <!-- Leaflet for 2D maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Header -->
    <header class="main-header">
        <div class="header-content">
            <div class="header-title-container">
                <h1 id="header-title" class="logo">Asteroid Impact Simulator</h1>
            </div>
            <div class="theme-toggle">
                <button class="mode-btn active" data-mode="simulation">
                    <span class="btn-text-full">Simulaci√≥n de Impacto</span>
                    <span class="btn-text-short">Simulaci√≥n</span>
                </button>
                <button class="mode-btn" data-mode="mitigation">
                    <span class="btn-text-full">Estrategias de Mitigaci√≥n</span>
                    <span class="btn-text-short">Mitigaci√≥n</span>
                </button>
                <button id="theme-toggle-btn" class="theme-toggle-btn" title="Cambiar tema">
                    <span class="theme-icon">‚óê</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Sidebar Toggle Button -->
        <button class="sidebar-toggle" id="sidebar-toggle" title="Abrir/cerrar panel">
            <span>‚ò∞</span>
        </button>
        
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebar-overlay"></div>
        
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Bento Dashboard -->
            <div class="bento-dashboard">
                <!-- Card 1: Impact Energy -->
                <div class="bento-card energy-card">
                    <div class="card-header">
                        <h3>Energ√≠a de Impacto</h3>
                        <span class="card-icon">üí•</span>
                    </div>
                    <div class="card-metric" id="impact-energy">0 MT</div>
                    <div class="card-trend" id="energy-trend">
                        <span class="trend-icon">‚ö°</span>
                        <span class="trend-text">Equivalente a bombas nucleares</span>
                    </div>
                </div>

                <!-- Card 2: Crater Size -->
                <div class="bento-card crater-card">
                    <div class="card-header">
                        <h3>Tama√±o del Cr√°ter</h3>
                        <span class="card-icon">üï≥Ô∏è</span>
                    </div>
                    <div class="card-metric" id="crater-diameter">0 km</div>
                    <div class="card-subtitle">Di√°metro estimado</div>
                </div>

                <!-- Card 3: Affected Population -->
                <div class="bento-card population-card">
                    <div class="card-header">
                        <h3>Poblaci√≥n Afectada</h3>
                        <span class="card-icon">üë•</span>
                    </div>
                    <div class="card-metric" id="affected-population">0</div>
                    <div class="card-trend" id="population-trend">
                        <span class="trend-icon">üìä</span>
                        <span class="trend-text">Personas en zona de riesgo</span>
                    </div>
                </div>


                <!-- Card 5: Asteroid Speed -->
                <div class="bento-card speed-card">
                    <div class="card-header">
                        <h3>Velocidad del Asteroide</h3>
                        <span class="card-icon">üöÄ</span>
                    </div>
                    <div class="card-metric" id="asteroid-speed">0 km/s</div>
                    <div class="card-subtitle">Velocidad de entrada</div>
                </div>

                <!-- Card 6: Destruction Radius -->
                <div class="bento-card radius-card">
                    <div class="card-header">
                        <h3>Radio de Destrucci√≥n</h3>
                        <span class="card-icon">üíÄ</span>
                    </div>
                    <div class="card-metric" id="destruction-radius">0 km</div>
                    <div class="card-trend" id="radius-trend">
                        <span class="trend-icon">üî•</span>
                        <span class="trend-text">Zona de destrucci√≥n total</span>
                    </div>
                </div>

                <!-- Card 7: Tsunami Risk -->
                <div class="bento-card tsunami-card">
                    <div class="card-header">
                        <h3>Riesgo de Tsunami</h3>
                        <span class="card-icon">üåä</span>
                    </div>
                    <div class="card-metric" id="tsunami-risk">Bajo</div>
                    <div class="card-subtitle">Si impacta en oc√©ano</div>
                </div>

                <!-- Card 8: Seismic Activity -->
                <div class="bento-card seismic-card">
                    <div class="card-header">
                        <h3>Actividad S√≠smica</h3>
                        <span class="card-icon">üåç</span>
                    </div>
                    <div class="card-metric" id="seismic-magnitude">0.0</div>
                    <div class="card-subtitle">Magnitud Richter</div>
                </div>

                <!-- Card 9: Simulation Status -->
                <div class="bento-card status-card">
                    <div class="card-header">
                        <h3>Estado de Simulaci√≥n</h3>
                        <span class="card-icon">‚öôÔ∏è</span>
                    </div>
                    <div class="card-metric" id="simulation-status">Listo</div>
                    <div class="card-trend" id="status-trend">
                        <span class="trend-icon">‚úÖ</span>
                        <span class="trend-text">Configura par√°metros</span>
                    </div>
                </div>
                
                <!-- New Simulation Button -->
                <div class="bento-card new-simulation-card">
                    <div class="card-header">
                        <h3>Nueva Simulaci√≥n</h3>
                        <span class="card-icon">üîÑ</span>
                    </div>
                    <button class="btn-primary" onclick="hideBentoDashboard()" style="width: 100%; margin-top: 8px;">
                        Configurar Nuevos Par√°metros
                    </button>
                </div>
            </div>

            <!-- Simulation Controls -->
            <div id="simulation-controls" class="controls-section active">
                <div class="section-title">Par√°metros del Asteroide</div>

                <div class="control-panel">
                    <!-- Asteroid Selection -->
                    <div class="control-group">
                        <label for="asteroid-select">Asteroide</label>
            <select id="asteroid-select">
                <option value="custom">Personalizado</option>
                <option value="loading" disabled>üîÑ Cargando asteroides de la NASA...</option>
            </select>
                    </div>

                    <!-- Diameter -->
                    <div class="control-group">
                        <label for="diameter">Di√°metro (metros)</label>
                        <input type="range" id="diameter" min="10" max="1000" value="150" step="10">
                        <span id="diameter-value" class="value-display">150 m</span>
                    </div>

                    <!-- Velocity -->
                    <div class="control-group">
                        <label for="velocity">Velocidad (km/s)</label>
                        <input type="range" id="velocity" min="5" max="50" value="25" step="1">
                        <span id="velocity-value" class="value-display">25 km/s</span>
                    </div>

                    <!-- Entry Angle -->
                    <div class="control-group">
                        <label for="angle">√Ångulo de Entrada (¬∞)</label>
                        <input type="range" id="angle" min="15" max="90" value="45" step="5">
                        <span id="angle-value" class="value-display">45¬∞</span>
                    </div>

                    <!-- Composicion de asteroide -->
                    <div class="control-group">
                        <label for="composition">Composici√≥n del Asteroide</label>
                        <select id="composition">
                            <option value="rocky">ü™® Rocoso (S-type) - Com√∫n</option>
                            <option value="metallic">‚öôÔ∏è Met√°lico (M-type) - Denso</option>
                            <option value="carbonaceous">üåë Carbon√°ceo (C-type) - Fr√°gil</option>
                            <option value="icy">‚ùÑÔ∏è Helado (Cometa) - Vol√°til</option>
                        </select>
                    </div>

                    <!-- Impact Location -->
                    <div class="control-group">
                        <label>Punto de Impacto</label>
                        <div class="location-inputs">
                            <input type="number" id="latitude" placeholder="Latitud" min="-90" max="90" value="40.7"
                                step="0.1">
                            <input type="number" id="longitude" placeholder="Longitud" min="-180" max="180"
                                value="-74.0" step="0.1">
                        </div>
                    </div>

                    <button id="simulate-btn" class="btn-primary">Simular Impacto</button>
                </div>

                <!-- Results Preview -->
                <div class="results-preview">
                    <div id="results-content" class="results-content">
                        <div class="placeholder">Ejecute una simulaci√≥n para ver los resultados</div>
                    </div>
                </div>

            </div>

            <!-- Mitigation Controls -->
            <div id="mitigation-controls" class="controls-section">
                <div class="section-title">Estrategia de Deflexi√≥n</div>

                <div class="control-panel">
                    <!-- Strategy Selection -->
                    <div class="control-group">
                        <label for="strategy-select">M√©todo</label>
                        <select id="strategy-select">
                            <option value="kinetic_impactor">Impactador Cin√©tico</option>
                            <option value="gravity_tractor">Tractor de Gravedad</option>
                        </select>
                    </div>

                    <!-- Asteroid Parameters -->
                    <div class="control-group">
                        <label for="mit-diameter">Di√°metro (m)</label>
                        <input type="range" id="mit-diameter" min="50" max="500" value="150" step="10">
                        <span id="mit-diameter-value" class="value-display">150 m</span>
                    </div>

                    <div class="control-group">
                        <label for="mit-velocity">Velocidad (km/s)</label>
                        <input type="range" id="mit-velocity" min="10" max="40" value="25" step="1">
                        <span id="mit-velocity-value" class="value-display">25 km/s</span>
                    </div>

                    <!-- Mission Parameters -->
                    <div class="control-group">
                        <label for="time-before-impact">Tiempo (d√≠as)</label>
                        <input type="range" id="time-before-impact" min="30" max="3650" value="365" step="30">
                        <span id="time-before-impact-value" class="value-display">365 d√≠as</span>
                    </div>

                    <div id="kinetic-params" class="strategy-params">
                        <div class="control-group">
                            <label for="impactor-mass">Masa Impactador (kg)</label>
                            <input type="range" id="impactor-mass" min="100" max="10000" value="1000" step="100">
                            <span id="impactor-mass-value" class="value-display">1000 kg</span>
                        </div>

                        <div class="control-group">
                            <label for="impactor-velocity">Velocidad Impactador (km/s)</label>
                            <input type="range" id="impactor-velocity" min="5" max="20" value="10" step="1">
                            <span id="impactor-velocity-value" class="value-display">10 km/s</span>
                        </div>
                    </div>

                    <button id="deflection-btn" class="btn-primary">Calcular Deflexi√≥n</button>
                </div>

                <!-- Deflection Results -->
                <div class="results-preview">
                    <div id="deflection-results" class="results-content">
                        <div class="placeholder">Ejecute una simulaci√≥n de deflexi√≥n para ver los resultados</div>
                    </div>
                </div>

            </div>
        </aside>

        <!-- Map Container -->
        <main class="map-main">
            <div id="map-container" class="map-container"></div>

            <!-- Map Legend -->
            <div class="map-legend">
                <div class="legend-item">
                    <span class="legend-dot destruction"></span>
                    <span>Destrucci√≥n Total</span>
                </div>
                <div class="legend-item">
                    <span class="legend-dot damage"></span>
                    <span>Da√±o Severo</span>
                </div>
                <div class="legend-item">
                    <span class="legend-dot affected"></span>
                    <span>√Årea Afectada</span>
                </div>
            </div>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loader"></div>
        <p>Calculando...</p>
    </div>

    <!-- Results Modal -->
    <div id="results-modal" class="results-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Resultados Completos del Impacto</h2>
                <button class="modal-close" onclick="closeResultsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modal-results-content"></div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeResultsModal()">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>